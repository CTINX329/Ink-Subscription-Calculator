<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ink Club Calculator (Internal)</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: #111;
      background: #1a1a1a;
      padding: 20px;
      margin: 0;
    }
    .calc-container {
      max-width: 1000px;
      margin: 0 auto;
    }
    .calc-card {
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 14px;
      padding: 20px;
      margin: 14px 0;
      background: #242424;
      color: #e8e8e8;
    }
    .calc-card h2 {
      margin: 0 0 8px;
      font-size: 20px;
      color: #fff;
    }
    .calc-card h3 {
      margin: 0 0 12px;
      font-size: 16px;
      color: #ccc;
    }
    .calc-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    .calc-grid-3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 14px;
    }
    .calc-grid-4 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 750px) {
      .calc-grid, .calc-grid-3, .calc-grid-4 {
        grid-template-columns: 1fr;
      }
    }
    .calc-field {
      margin-bottom: 14px;
    }
    .calc-label {
      display: block;
      font-size: 12px;
      color: #999;
      margin: 0 0 6px;
      font-weight: 600;
    }
    .calc-input,
    .calc-select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.15);
      outline: none;
      font-size: 14px;
      background: #1a1a1a;
      color: #fff;
      font-family: inherit;
    }
    .calc-input:focus,
    .calc-select:focus {
      border-color: rgba(255,255,255,.3);
    }
    .calc-input::placeholder {
      color: #666;
    }
    .calc-muted {
      font-size: 12px;
      color: #777;
      line-height: 1.4;
      margin-top: 4px;
    }
    .calc-pill {
      display: inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.1);
      font-size: 11px;
      color: #aaa;
      background: rgba(255,255,255,.05);
      margin: 3px 3px 3px 0;
    }
    .calc-pill-yes {
      background: rgba(80,200,120,.15);
      border-color: rgba(80,200,120,.3);
      color: #6fcf97;
    }
    .calc-pill-no {
      background: rgba(200,80,80,.15);
      border-color: rgba(200,80,80,.3);
      color: #cf6f6f;
    }
    .calc-result {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .calc-result-3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
    }
    .calc-result-4 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 750px) {
      .calc-result, .calc-result-3, .calc-result-4 {
        grid-template-columns: 1fr;
      }
    }
    .calc-kpi {
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 12px;
      padding: 14px;
      background: rgba(255,255,255,.03);
    }
    .calc-kpi-blue {
      background: rgba(80,160,255,.1);
      border-color: rgba(80,160,255,.25);
    }
    .calc-kpi-orange {
      background: rgba(255,160,80,.1);
      border-color: rgba(255,160,80,.25);
    }
    .calc-kpi-green {
      background: rgba(80,200,120,.1);
      border-color: rgba(80,200,120,.25);
    }
    .calc-kpi-red {
      background: rgba(255,80,80,.1);
      border-color: rgba(255,80,80,.25);
    }
    .calc-kpi-purple {
      background: rgba(160,100,220,.1);
      border-color: rgba(160,100,220,.25);
    }
    .calc-kpi-yellow {
      background: rgba(220,200,80,.1);
      border-color: rgba(220,200,80,.25);
    }
    .calc-kpi-label {
      font-size: 12px;
      color: #888;
    }
    .calc-kpi-value {
      font-size: 24px;
      font-weight: 700;
      margin-top: 4px;
      color: #fff;
    }
    .calc-kpi-value.small {
      font-size: 18px;
    }
    .calc-kpi-value.code {
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 20px;
    }
    .calc-kpi-sub {
      font-size: 12px;
      color: #777;
      margin-top: 6px;
      line-height: 1.4;
    }
    .calc-divider {
      height: 1px;
      background: rgba(255,255,255,.08);
      margin: 18px 0;
    }
    .calc-btn {
      padding: 11px 20px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.15);
      background: #fff;
      color: #111;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
    }
    .calc-btn:hover {
      background: #e0e0e0;
    }
    .calc-btn-secondary {
      background: #333;
      color: #fff;
      border-color: rgba(255,255,255,.2);
    }
    .calc-btn-secondary:hover {
      background: #444;
    }
    .calc-section-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #666;
      margin-bottom: 10px;
      font-weight: 600;
    }
    .calc-warn {
      border-left: 4px solid rgba(255,160,80,.6);
      padding: 12px;
      margin-top: 12px;
      background: rgba(255,160,80,.08);
      border-radius: 0 10px 10px 0;
      color: #ccc;
    }
    .calc-alert {
      border-left: 4px solid rgba(255,80,80,.6);
      padding: 12px;
      margin-top: 12px;
      background: rgba(255,80,80,.08);
      border-radius: 0 10px 10px 0;
      color: #ccc;
    }
    .calc-info {
      border-left: 4px solid rgba(80,160,255,.6);
      padding: 12px;
      margin-top: 12px;
      background: rgba(80,160,255,.08);
      border-radius: 0 10px 10px 0;
      color: #ccc;
    }
    .calc-success {
      border-left: 4px solid rgba(80,200,120,.6);
      padding: 12px;
      margin-top: 12px;
      background: rgba(80,200,120,.08);
      border-radius: 0 10px 10px 0;
      color: #ccc;
    }
    .internal-badge {
      display: inline-block;
      background: rgba(255,80,80,.2);
      color: #ff9999;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-left: 10px;
      vertical-align: middle;
    }
    .erp-badge {
      display: inline-block;
      background: rgba(80,200,120,.2);
      color: #88ddaa;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-left: 10px;
      vertical-align: middle;
    }
    .scenario-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      margin-top: 10px;
    }
    .scenario-table th,
    .scenario-table td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,.06);
      color: #ccc;
    }
    .scenario-table th {
      font-weight: 600;
      color: #888;
      font-size: 11px;
      text-transform: uppercase;
    }
    .scenario-table tr:last-child td {
      border-bottom: none;
    }
    .scenario-table .highlight {
      background: rgba(80,200,120,.1);
    }
    .scenario-table .warning {
      background: rgba(255,180,80,.1);
    }
    .scenario-table .danger {
      background: rgba(255,80,80,.15);
    }
    .scenario-table .credit {
      background: rgba(160,100,220,.1);
    }
    .copy-output {
      background: #1a1a1a;
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 10px;
      padding: 16px;
      font-size: 12px;
      line-height: 1.5;
      white-space: pre-wrap;
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      color: #aaa;
      max-height: 280px;
      overflow-y: auto;
    }
    .journal-entry {
      background: #1a1a1a;
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 10px;
      padding: 16px;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 13px;
      color: #aaa;
    }
    .journal-entry .debit {
      color: #ff9999;
    }
    .journal-entry .credit {
      color: #99ddaa;
      padding-left: 30px;
    }
    .timeline {
      display: flex;
      gap: 0;
      margin-top: 12px;
    }
    .timeline-step {
      flex: 1;
      padding: 12px;
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.08);
    }
    .timeline-step:first-child {
      border-radius: 10px 0 0 10px;
    }
    .timeline-step:last-child {
      border-radius: 0 10px 10px 0;
    }
    .timeline-step-title {
      font-size: 11px;
      text-transform: uppercase;
      color: #888;
      margin-bottom: 6px;
    }
    .timeline-step-action {
      font-size: 12px;
      color: #ccc;
      line-height: 1.4;
    }
    .timeline-step.green { background: rgba(80,200,120,.1); border-color: rgba(80,200,120,.3); }
    .timeline-step.yellow { background: rgba(255,200,80,.1); border-color: rgba(255,200,80,.3); }
    .timeline-step.orange { background: rgba(255,150,80,.15); border-color: rgba(255,150,80,.4); }
    .timeline-step.red { background: rgba(255,80,80,.1); border-color: rgba(255,80,80,.3); }
    .timeline-step.purple { background: rgba(160,100,220,.1); border-color: rgba(160,100,220,.3); }
    .timeline-step.blue { background: rgba(80,160,255,.1); border-color: rgba(80,160,255,.3); }
    @media (max-width: 750px) {
      .timeline { flex-direction: column; }
      .timeline-step:first-child { border-radius: 10px 10px 0 0; }
      .timeline-step:last-child { border-radius: 0 0 10px 10px; }
    }
    .december-section {
      border: 2px solid rgba(160,100,220,.3);
      background: linear-gradient(135deg, #242424 0%, #2a2535 100%);
    }
    .erp-section {
      border: 2px solid rgba(80,200,120,.3);
      background: linear-gradient(135deg, #242424 0%, #232a25 100%);
    }
  </style>
</head>
<body>
  <div class="calc-container">
    
    <!-- Header -->
    <div class="calc-card">
      <h2>Ink Club Calculator <span class="internal-badge">Internal</span></h2>
      <div class="calc-muted">
        Size Ink Club accounts with fixed monthly pricing, automated ERP pricing via FC multiplier, and year-end reconciliation.
      </div>
      <div style="margin-top: 14px;">
        <span class="calc-section-label">Included Products</span><br>
        <span class="calc-pill calc-pill-yes">Paper Series</span>
        <span class="calc-pill calc-pill-yes">Direct/Indirect Thermal</span>
        <span class="calc-pill calc-pill-yes">Laminating Films</span>
        <span class="calc-pill calc-pill-yes">Baseline Pigments</span>
        <span class="calc-pill calc-pill-yes">Pre-Mixed PMS</span>
        <span class="calc-pill calc-pill-yes">Extenders & OPVs</span>
        <span class="calc-pill calc-pill-yes">Opaque White</span>
      </div>
      <div style="margin-top: 10px;">
        <span class="calc-section-label">Excluded (Billed Separately)</span><br>
        <span class="calc-pill calc-pill-no">Fluorescents</span>
        <span class="calc-pill calc-pill-no">Metallics</span>
        <span class="calc-pill calc-pill-no">UV/LED Systems</span>
        <span class="calc-pill calc-pill-no">Specialty Pigments</span>
      </div>
    </div>

    <!-- Account Setup -->
    <div class="calc-card">
      <h3>Account Setup</h3>
      <div class="calc-grid">
        <div class="calc-field">
          <label class="calc-label" for="customerName">Customer Name</label>
          <input class="calc-input" id="customerName" type="text" placeholder="e.g., ABC Printing Co.">
        </div>
        <div class="calc-field">
          <label class="calc-label" for="agreementStart">Agreement Start</label>
          <select class="calc-select" id="agreementStart">
            <option value="jan">January (full year)</option>
            <option value="mid">Mid-Year Start</option>
          </select>
          <div class="calc-muted">Mid-year: first reconciliation following December</div>
        </div>
        <div class="calc-field">
          <label class="calc-label" for="historicalAnnual">Historical Annual Purchases ($)</label>
          <input class="calc-input" id="historicalAnnual" type="text" inputmode="decimal" placeholder="e.g., 120000" value="120000">
          <div class="calc-muted">What they paid us last 12 months</div>
        </div>
        <div class="calc-field">
          <label class="calc-label" for="historicalMargin">Historical Margin (%)</label>
          <input class="calc-input" id="historicalMargin" type="number" min="15" max="65" step="0.5" value="42">
          <div class="calc-muted">Our actual margin on this account</div>
        </div>
      </div>
    </div>

    <!-- Pricing -->
    <div class="calc-card">
      <h3>Ink Club Pricing</h3>
      <div class="calc-grid-3">
        <div class="calc-field">
          <label class="calc-label" for="discountOffered">Discount Offered (%)</label>
          <input class="calc-input" id="discountOffered" type="number" min="0" max="20" step="0.5" value="10">
          <div class="calc-muted">Off their historical spend</div>
        </div>
        <div class="calc-field">
          <label class="calc-label" for="contractTerm">Agreement Term (months)</label>
          <input class="calc-input" id="contractTerm" type="number" min="6" max="36" step="1" value="12">
        </div>
        <div class="calc-field">
          <label class="calc-label" for="paymentTerms">Payment Terms</label>
          <select class="calc-select" id="paymentTerms">
            <option value="30" selected>NET 30</option>
            <option value="15">NET 15</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Customer Quote -->
    <div class="calc-card">
      <h3>Customer Quote</h3>
      <div class="calc-result-4">
        <div class="calc-kpi calc-kpi-blue">
          <div class="calc-kpi-label">Monthly Rate</div>
          <div class="calc-kpi-value" id="monthlyRate">$0</div>
          <div class="calc-kpi-sub">Flat fee, NET <span id="netTermsDisplay">30</span></div>
        </div>
        <div class="calc-kpi calc-kpi-blue">
          <div class="calc-kpi-label">Annual Value</div>
          <div class="calc-kpi-value" id="annualValue">$0</div>
          <div class="calc-kpi-sub" id="termDisplay">12-month term</div>
        </div>
        <div class="calc-kpi calc-kpi-green">
          <div class="calc-kpi-label">Customer Savings</div>
          <div class="calc-kpi-value" id="customerSavings">$0</div>
          <div class="calc-kpi-sub" id="savingsPct">per year</div>
        </div>
        <div class="calc-kpi calc-kpi-purple">
          <div class="calc-kpi-label">Potential Year-End Credit</div>
          <div class="calc-kpi-value small" id="maxCredit">Up to $0</div>
          <div class="calc-kpi-sub">If usage under 85%</div>
        </div>
      </div>
    </div>

    <!-- ERP / eMixer Configuration -->
    <div class="calc-card erp-section">
      <h3>eMixer Configuration <span class="erp-badge">ERP Setup</span></h3>
      <div class="calc-muted" style="margin-bottom: 14px;">
        These values configure the customer in eMixer. Orders auto-price at FC Ã— Multiplier, no CS involvement needed.
      </div>
      
      <div class="calc-result-4">
        <div class="calc-kpi calc-kpi-green">
          <div class="calc-kpi-label">FC Multiplier</div>
          <div class="calc-kpi-value code" id="fcMultiplier">Ã— 1.55</div>
          <div class="calc-kpi-sub">Enter in eMixer</div>
        </div>
        <div class="calc-kpi calc-kpi-green">
          <div class="calc-kpi-label">Monthly FC Budget</div>
          <div class="calc-kpi-value" id="monthlyFCBudget">$0</div>
          <div class="calc-kpi-sub">Expected FC/month</div>
        </div>
        <div class="calc-kpi calc-kpi-yellow">
          <div class="calc-kpi-label">Soft Limit (FC)</div>
          <div class="calc-kpi-value" id="softLimitFC">$0</div>
          <div class="calc-kpi-sub">Flag at +15%</div>
        </div>
        <div class="calc-kpi calc-kpi-red">
          <div class="calc-kpi-label">Hard Limit (FC)</div>
          <div class="calc-kpi-value" id="hardLimitFC">$0</div>
          <div class="calc-kpi-sub">Overage at 1.5Ã—</div>
        </div>
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">How It Works</div>
      <div class="calc-info" style="margin-top: 0;">
        <b>Order Flow:</b><br>
        1. Customer places order in eMixer<br>
        2. eMixer calculates Formula Cost (FC) for the batch<br>
        3. System sees "Ink Club" flag â†’ applies FC Ã— <span id="multiplierInline">1.55</span><br>
        4. Order goes to production (no CS pricing step)<br>
        5. ERP books revenue at Internal Price (FC Ã— multiplier)<br>
        6. End of month: Reconcile to flat monthly rate
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">Multiplier Math</div>
      <div class="calc-grid">
        <div>
          <div class="calc-muted" style="margin-bottom: 8px;"><b>Full Price Multiplier</b> (at historical margin)</div>
          <div style="font-family: monospace; color: #aaa; font-size: 14px;">
            1 Ã· (1 - <span id="histMarginCalc">42%</span>) = <span id="fullMultiplier">1.72</span>
          </div>
        </div>
        <div>
          <div class="calc-muted" style="margin-bottom: 8px;"><b>Discounted Multiplier</b> (for Ink Club)</div>
          <div style="font-family: monospace; color: #aaa; font-size: 14px;">
            <span id="fullMultiplier2">1.72</span> Ã— (1 - <span id="discountCalc">10%</span>) = <span id="discountedMultiplier">1.55</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Monthly Reconciliation -->
    <div class="calc-card erp-section">
      <h3>Monthly Reconciliation <span class="erp-badge">ERP Adjustment</span></h3>
      <div class="calc-muted" style="margin-bottom: 14px;">
        ERP books each order at Internal Price. At month-end, reconcile to the flat Ink Club rate.
      </div>
      
      <div class="calc-section-label">Scenario Calculator</div>
      <div class="calc-grid-3">
        <div class="calc-field">
          <label class="calc-label" for="actualFC">Actual FC Shipped This Month ($)</label>
          <input class="calc-input" id="actualFC" type="text" inputmode="decimal" placeholder="e.g., 5000" value="5000">
        </div>
        <div class="calc-field">
          <label class="calc-label">Internal Price (FC Ã— Multiplier)</label>
          <input class="calc-input" id="internalPrice" type="text" readonly disabled>
        </div>
        <div class="calc-field">
          <label class="calc-label">Adjustment Needed</label>
          <input class="calc-input" id="adjustmentAmount" type="text" readonly disabled>
        </div>
      </div>
      
      <div class="calc-result-3" style="margin-top: 10px;">
        <div class="calc-kpi">
          <div class="calc-kpi-label">ERP Booked Revenue</div>
          <div class="calc-kpi-value small" id="erpBookedRevenue">$0</div>
          <div class="calc-kpi-sub">Sum of Internal Prices</div>
        </div>
        <div class="calc-kpi">
          <div class="calc-kpi-label">Ink Club Rate</div>
          <div class="calc-kpi-value small" id="inkClubRateDisplay">$0</div>
          <div class="calc-kpi-sub">What customer pays</div>
        </div>
        <div class="calc-kpi" id="adjustmentKpi">
          <div class="calc-kpi-label">Reconciliation</div>
          <div class="calc-kpi-value small" id="reconciliationAmount">$0</div>
          <div class="calc-kpi-sub" id="reconciliationType">adjustment</div>
        </div>
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">Journal Entry</div>
      <div class="journal-entry" id="journalEntry">
        Loading...
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">Monthly Scenarios</div>
      <table class="scenario-table">
        <thead>
          <tr>
            <th>FC Shipped</th>
            <th>Internal Price</th>
            <th>Adjustment</th>
            <th>Net Revenue</th>
            <th>Actual Margin</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="monthlyScenarioBody"></tbody>
      </table>
    </div>

    <!-- Account Limits -->
    <div class="calc-card">
      <h3>Account Limits & Controls</h3>
      <div class="calc-grid-3">
        <div class="calc-field">
          <label class="calc-label" for="softCapPct">Soft Limit Buffer (%)</label>
          <input class="calc-input" id="softCapPct" type="number" min="5" max="25" step="1" value="15">
          <div class="calc-muted">Internal flag threshold</div>
        </div>
        <div class="calc-field">
          <label class="calc-label" for="hardCapMultiplier">Hard Limit (Ã— baseline)</label>
          <input class="calc-input" id="hardCapMultiplier" type="number" min="1.25" max="2.5" step="0.05" value="1.5">
          <div class="calc-muted">Overage billing threshold</div>
        </div>
        <div class="calc-field">
          <label class="calc-label" for="overageMarkup">Overage Markup (%)</label>
          <input class="calc-input" id="overageMarkup" type="number" min="25" max="75" step="5" value="50">
          <div class="calc-muted">On FC beyond hard limit</div>
        </div>
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">Payment Controls</div>
      <div class="calc-grid">
        <div class="calc-field">
          <label class="calc-label" for="creditHoldDays">Credit Hold (days past due)</label>
          <input class="calc-input" id="creditHoldDays" type="number" min="1" max="30" step="1" value="15">
          <div class="calc-muted">Stop shipping</div>
        </div>
        <div class="calc-field">
          <label class="calc-label" for="accountSuspendDays">Account Suspend (days past due)</label>
          <input class="calc-input" id="accountSuspendDays" type="number" min="30" max="90" step="1" value="45">
          <div class="calc-muted">Require full payment</div>
        </div>
      </div>
      
      <div class="calc-section-label" style="margin-top: 18px;">Payment Timeline (Jan-Nov)</div>
      <div class="timeline">
        <div class="timeline-step green">
          <div class="timeline-step-title">Day 1-<span id="netDays1">30</span></div>
          <div class="timeline-step-action">Normal. Ship as ordered.</div>
        </div>
        <div class="timeline-step yellow">
          <div class="timeline-step-title">Day <span id="netDays2">31</span>-<span id="holdDays">45</span></div>
          <div class="timeline-step-action">Past due. Reminder sent.</div>
        </div>
        <div class="timeline-step orange">
          <div class="timeline-step-title">Day <span id="holdDays2">46</span>+</div>
          <div class="timeline-step-action"><b>Credit hold.</b> Stop shipping.</div>
        </div>
        <div class="timeline-step red">
          <div class="timeline-step-title">Day <span id="suspendDays">76</span>+</div>
          <div class="timeline-step-action"><b>Suspended.</b> Full payment required.</div>
        </div>
      </div>
    </div>

    <!-- Year-End Reconciliation -->
    <div class="calc-card december-section">
      <h3>ğŸ“… Year-End Reconciliation (December)</h3>
      <div class="calc-muted" style="margin-bottom: 14px;">
        Annual settle-up. All AR paid by deadline. Customers under baseline receive credit applied to January.
      </div>
      
      <div class="calc-grid-3">
        <div class="calc-field">
          <label class="calc-label" for="creditThreshold">Credit Threshold (% under baseline)</label>
          <input class="calc-input" id="creditThreshold" type="number" min="10" max="25" step="1" value="15">
        </div>
        <div class="calc-field">
          <label class="calc-label" for="creditPct">Credit Percentage (%)</label>
          <input class="calc-input" id="creditPct" type="number" min="25" max="75" step="5" value="50">
        </div>
        <div class="calc-field">
          <label class="calc-label" for="decPaymentDeadline">Payment Deadline</label>
          <select class="calc-select" id="decPaymentDeadline">
            <option value="15">December 15</option>
            <option value="20" selected>December 20</option>
          </select>
        </div>
      </div>
      
      <div class="calc-section-label" style="margin-top: 14px;">December Timeline</div>
      <div class="timeline">
        <div class="timeline-step green">
          <div class="timeline-step-title">Nov</div>
          <div class="timeline-step-action">Last full shipping month.</div>
        </div>
        <div class="timeline-step yellow">
          <div class="timeline-step-title">Dec 1-15</div>
          <div class="timeline-step-action">Ship only if current thru Oct.</div>
        </div>
        <div class="timeline-step orange">
          <div class="timeline-step-title">Dec 15</div>
          <div class="timeline-step-action"><b>Shipping cutoff.</b></div>
        </div>
        <div class="timeline-step red">
          <div class="timeline-step-title">Dec <span id="deadlineDay">20</span></div>
          <div class="timeline-step-action"><b>All AR due.</b></div>
        </div>
        <div class="timeline-step purple">
          <div class="timeline-step-title">Dec 21-31</div>
          <div class="timeline-step-action">Calculate credits.</div>
        </div>
        <div class="timeline-step blue">
          <div class="timeline-step-title">Jan 1</div>
          <div class="timeline-step-action">Credits applied. Clean slate.</div>
        </div>
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">Year-End Scenarios</div>
      <table class="scenario-table">
        <thead>
          <tr>
            <th>Annual FC</th>
            <th>% of Baseline</th>
            <th>Year-End Result</th>
            <th>Annual Margin</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="yearEndScenarioBody"></tbody>
      </table>
      
      <div class="calc-success">
        <b>Credit Requirements:</b> All invoices paid by December <span id="deadlineDay2">20</span>. Outstanding balance = no credit eligibility.
      </div>
    </div>

    <!-- Sales Talking Points -->
    <div class="calc-card">
      <h3>Sales Talking Points</h3>
      <div class="calc-info">
        <b>The Pitch:</b><br><br>
        "We're setting up a <b id="talkMonthly">$X</b>/month ink account for you â€” <b id="talkDiscount">10%</b> less than what you paid last year. Same NET <span id="talkTerms">30</span> terms.<br><br>
        You order what you need, we ship it, you get one flat monthly invoice. No per-pound pricing, no surprises.<br><br>
        At year-end, we reconcile. If you used significantly less than planned, we credit your January invoice. All we ask is invoices paid by December <span id="talkDeadline">20</span> so we can close books clean."
      </div>
      
      <div class="calc-divider"></div>
      
      <div class="calc-section-label">Objection Handling</div>
      <div class="calc-warn" style="margin-top: 0;">
        <b>"What if I use less?"</b><br>
        "If you're more than <span id="objectionThreshold">15%</span> under baseline at year-end, you get a credit on January's invoice. You're protected."
      </div>
      <div class="calc-warn">
        <b>"What if I need way more?"</b><br>
        "We monitor monthly. If you're consistently over, we'll right-size at renewal. No surprise bills â€” we're partners."
      </div>
    </div>

    <!-- Export -->
    <div class="calc-card">
      <h3>Export</h3>
      <div class="calc-section-label">Internal Documentation</div>
      <div class="copy-output" id="exportOutput">Loading...</div>
      <div style="margin-top: 12px; display: flex; gap: 10px; flex-wrap: wrap;">
        <button class="calc-btn" onclick="copyExport()">Copy to Clipboard</button>
        <button class="calc-btn calc-btn-secondary" onclick="downloadExport()">Download .txt</button>
      </div>
    </div>

  </div>

  <script>
    function $(id) { return document.getElementById(id); }
    
    function formatUSD(n) {
      if (!isFinite(n)) n = 0;
      return n.toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 });
    }
    
    function formatUSD2(n) {
      if (!isFinite(n)) n = 0;
      return n.toLocaleString('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    
    function parseMoney(v) {
      const cleaned = String(v || '').replace(/[^0-9.]/g, '');
      const num = parseFloat(cleaned);
      return isFinite(num) ? num : 0;
    }
    
    function calculate() {
      // Inputs
      const customerName = $('customerName').value || 'Customer';
      const agreementStart = $('agreementStart').value;
      const historicalAnnual = parseMoney($('historicalAnnual').value);
      const historicalMargin = Math.max(15, Math.min(65, parseFloat($('historicalMargin').value) || 42)) / 100;
      const discountOffered = Math.max(0, Math.min(20, parseFloat($('discountOffered').value) || 10)) / 100;
      const contractTerm = Math.max(6, Math.min(36, parseInt($('contractTerm').value) || 12));
      const paymentTerms = parseInt($('paymentTerms').value) || 30;
      const softCapPct = Math.max(5, Math.min(25, parseFloat($('softCapPct').value) || 15)) / 100;
      const hardCapMultiplier = Math.max(1.25, Math.min(2.5, parseFloat($('hardCapMultiplier').value) || 1.5));
      const overageMarkup = Math.max(25, Math.min(75, parseFloat($('overageMarkup').value) || 50)) / 100;
      const creditThreshold = Math.max(10, Math.min(25, parseFloat($('creditThreshold').value) || 15)) / 100;
      const creditPct = Math.max(25, Math.min(75, parseFloat($('creditPct').value) || 50)) / 100;
      const decPaymentDeadline = parseInt($('decPaymentDeadline').value) || 20;
      const creditHoldDays = Math.max(1, Math.min(30, parseInt($('creditHoldDays').value) || 15));
      const accountSuspendDays = Math.max(30, Math.min(90, parseInt($('accountSuspendDays').value) || 45));
      const actualFC = parseMoney($('actualFC').value);
      
      // Core calculations
      const annualRate = historicalAnnual * (1 - discountOffered);
      const monthlyRate = annualRate / 12;
      const customerSavings = historicalAnnual - annualRate;
      
      const historicalCOGS = historicalAnnual * (1 - historicalMargin);
      const monthlyCOGS = historicalCOGS / 12;
      
      // FC Multiplier calculation
      const fullMultiplier = 1 / (1 - historicalMargin);
      const discountedMultiplier = fullMultiplier * (1 - discountOffered);
      
      // Limits (in FC terms)
      const softLimitFC = monthlyCOGS * (1 + softCapPct);
      const hardLimitFC = monthlyCOGS * hardCapMultiplier;
      
      // Year-end credit
      const creditThresholdPct = 1 - creditThreshold;
      const maxCreditFC = historicalCOGS * creditThreshold;
      const maxCredit = maxCreditFC * discountedMultiplier * creditPct;
      
      // Monthly reconciliation
      const internalPrice = actualFC * discountedMultiplier;
      const adjustment = monthlyRate - internalPrice;
      const actualMargin = monthlyRate > 0 ? (monthlyRate - actualFC) / monthlyRate : 0;
      
      // Payment timeline
      const holdStartDay = paymentTerms + creditHoldDays;
      const suspendStartDay = paymentTerms + accountSuspendDays;
      
      // =====================
      // UPDATE DISPLAYS
      // =====================
      
      // Customer quote
      $('monthlyRate').textContent = formatUSD(monthlyRate);
      $('netTermsDisplay').textContent = paymentTerms;
      $('annualValue').textContent = formatUSD(annualRate);
      $('termDisplay').textContent = contractTerm + '-month term';
      $('customerSavings').textContent = formatUSD(customerSavings);
      $('savingsPct').textContent = (discountOffered * 100).toFixed(0) + '% savings/year';
      $('maxCredit').textContent = 'Up to ' + formatUSD(maxCredit);
      
      // ERP Configuration
      $('fcMultiplier').textContent = 'Ã— ' + discountedMultiplier.toFixed(2);
      $('monthlyFCBudget').textContent = formatUSD(monthlyCOGS);
      $('softLimitFC').textContent = formatUSD(softLimitFC);
      $('hardLimitFC').textContent = formatUSD(hardLimitFC);
      $('multiplierInline').textContent = discountedMultiplier.toFixed(2);
      
      // Multiplier math display
      $('histMarginCalc').textContent = (historicalMargin * 100).toFixed(0) + '%';
      $('fullMultiplier').textContent = fullMultiplier.toFixed(2);
      $('fullMultiplier2').textContent = fullMultiplier.toFixed(2);
      $('discountCalc').textContent = (discountOffered * 100).toFixed(0) + '%';
      $('discountedMultiplier').textContent = discountedMultiplier.toFixed(2);
      
      // Monthly reconciliation
      $('internalPrice').value = formatUSD(internalPrice);
      $('adjustmentAmount').value = (adjustment >= 0 ? '+' : '') + formatUSD(adjustment);
      $('erpBookedRevenue').textContent = formatUSD(internalPrice);
      $('inkClubRateDisplay').textContent = formatUSD(monthlyRate);
      $('reconciliationAmount').textContent = formatUSD(Math.abs(adjustment));
      
      const adjustKpi = $('adjustmentKpi');
      if (adjustment >= 0) {
        $('reconciliationType').textContent = 'Add to revenue';
        adjustKpi.className = 'calc-kpi calc-kpi-green';
      } else {
        $('reconciliationType').textContent = 'Reduce revenue';
        adjustKpi.className = 'calc-kpi calc-kpi-red';
      }
      
      // Journal entry
      let journalHTML = '';
      if (Math.abs(adjustment) < 1) {
        journalHTML = `<span style="color: #888;">No adjustment needed â€” Internal Price â‰ˆ Ink Club Rate</span>`;
      } else if (adjustment > 0) {
        journalHTML = `<div style="margin-bottom: 8px; color: #888;">Ink Club Reconciliation - ${customerName} - [Month]</div>`;
        journalHTML += `<div class="debit">Debit: Accounts Receivable    ${formatUSD2(adjustment)}</div>`;
        journalHTML += `<div class="credit">Credit: Ink Club Revenue    ${formatUSD2(adjustment)}</div>`;
        journalHTML += `<div style="margin-top: 12px; color: #777; font-size: 11px;">Customer ordered less than baseline. Increase AR to match flat rate.</div>`;
      } else {
        journalHTML = `<div style="margin-bottom: 8px; color: #888;">Ink Club Reconciliation - ${customerName} - [Month]</div>`;
        journalHTML += `<div class="debit">Debit: Ink Club Adjustment    ${formatUSD2(Math.abs(adjustment))}</div>`;
        journalHTML += `<div class="credit">Credit: Accounts Receivable    ${formatUSD2(Math.abs(adjustment))}</div>`;
        journalHTML += `<div style="margin-top: 12px; color: #777; font-size: 11px;">Customer ordered more than baseline. Reduce AR to match flat rate.</div>`;
      }
      $('journalEntry').innerHTML = journalHTML;
      
      // Payment timeline
      $('netDays1').textContent = paymentTerms;
      $('netDays2').textContent = paymentTerms + 1;
      $('holdDays').textContent = holdStartDay;
      $('holdDays2').textContent = holdStartDay + 1;
      $('suspendDays').textContent = suspendStartDay + 1;
      
      // December
      $('deadlineDay').textContent = decPaymentDeadline;
      $('deadlineDay2').textContent = decPaymentDeadline;
      
      // Talking points
      $('talkMonthly').textContent = formatUSD(monthlyRate);
      $('talkDiscount').textContent = (discountOffered * 100).toFixed(0) + '%';
      $('talkTerms').textContent = paymentTerms;
      $('talkDeadline').textContent = decPaymentDeadline;
      $('objectionThreshold').textContent = (creditThreshold * 100).toFixed(0) + '%';
      
      // =====================
      // MONTHLY SCENARIOS
      // =====================
      const monthlyScenarios = [
        { label: '50%', factor: 0.50 },
        { label: '75%', factor: 0.75 },
        { label: '100% (baseline)', factor: 1.00 },
        { label: '115% (soft)', factor: 1 + softCapPct },
        { label: '150% (hard)', factor: hardCapMultiplier },
        { label: '200%', factor: 2.00 },
      ];
      
      let monthlyHTML = '';
      monthlyScenarios.forEach(s => {
        const fc = monthlyCOGS * s.factor;
        const intPrice = fc * discountedMultiplier;
        const adj = monthlyRate - intPrice;
        const netRev = monthlyRate; // Always the flat rate
        const margin = netRev > 0 ? (netRev - fc) / netRev : 0;
        
        let status = 'âœ“ OK';
        let rowClass = '';
        if (s.factor === 1.00) { rowClass = 'highlight'; status = 'â— Baseline'; }
        else if (s.factor >= hardCapMultiplier) { rowClass = 'danger'; status = 'ğŸ›‘ Overage'; }
        else if (s.factor >= 1 + softCapPct) { rowClass = 'warning'; status = 'âš ï¸ Flag'; }
        else if (s.factor < 1) { status = 'âœ“ Under'; }
        
        const adjStr = adj >= 0 ? '+' + formatUSD(adj) : formatUSD(adj);
        
        monthlyHTML += `<tr class="${rowClass}">
          <td>${formatUSD(fc)}</td>
          <td>${formatUSD(intPrice)}</td>
          <td>${adjStr}</td>
          <td>${formatUSD(netRev)}</td>
          <td>${(margin * 100).toFixed(1)}%</td>
          <td>${status}</td>
        </tr>`;
      });
      $('monthlyScenarioBody').innerHTML = monthlyHTML;
      
      // =====================
      // YEAR-END SCENARIOS
      // =====================
      const yearEndScenarios = [
        { label: '70%', factor: 0.70 },
        { label: '85% (threshold)', factor: creditThresholdPct },
        { label: '100%', factor: 1.00 },
        { label: '115%', factor: 1.15 },
        { label: '150% (hard)', factor: hardCapMultiplier },
      ];
      
      let yearEndHTML = '';
      yearEndScenarios.forEach(s => {
        const annualFC = historicalCOGS * s.factor;
        const pctOfBaseline = s.factor * 100;
        let yearEndResult = 'â€”';
        let annualRevenue = annualRate;
        
        // Calculate overage revenue if over hard limit
        const annualHardLimit = hardLimitFC * 12;
        if (annualFC > annualHardLimit) {
          const overage = annualFC - annualHardLimit;
          const overageRev = overage * (1 + overageMarkup);
          annualRevenue += overageRev;
          yearEndResult = 'Overage: +' + formatUSD(overageRev);
        }
        
        // Calculate credit if under threshold
        if (s.factor <= creditThresholdPct) {
          const unusedFC = historicalCOGS - annualFC;
          const credit = unusedFC * discountedMultiplier * creditPct;
          yearEndResult = 'Credit: ' + formatUSD(credit);
        } else if (s.factor <= 1 && annualFC <= annualHardLimit) {
          yearEndResult = 'No adjustment';
        }
        
        const margin = annualRevenue > 0 ? (annualRevenue - annualFC) / annualRevenue : 0;
        
        let status = 'âœ“ OK';
        let rowClass = '';
        if (s.factor === 1.00) { rowClass = 'highlight'; status = 'â— Baseline'; }
        else if (s.factor <= creditThresholdPct) { rowClass = 'credit'; status = 'ğŸ’° Credit'; }
        else if (s.factor >= hardCapMultiplier) { rowClass = 'danger'; status = 'ğŸ›‘ Overage'; }
        else if (s.factor > 1) { rowClass = 'warning'; status = 'âš ï¸ Over'; }
        
        yearEndHTML += `<tr class="${rowClass}">
          <td>${formatUSD(annualFC)}</td>
          <td>${pctOfBaseline.toFixed(0)}%</td>
          <td>${yearEndResult}</td>
          <td>${(margin * 100).toFixed(1)}%</td>
          <td>${status}</td>
        </tr>`;
      });
      $('yearEndScenarioBody').innerHTML = yearEndHTML;
      
      // =====================
      // EXPORT
      // =====================
      const exportText = `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
INK CLUB â€” INTERNAL DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CUSTOMER: ${customerName}
DATE: ${new Date().toLocaleDateString()}
AGREEMENT START: ${agreementStart === 'jan' ? 'January (full year)' : 'Mid-Year'}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CUSTOMER-FACING TERMS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Monthly Rate:          ${formatUSD(monthlyRate)}
Annual Value:          ${formatUSD(annualRate)}
Agreement Term:        ${contractTerm} months
Payment Terms:         NET ${paymentTerms}

Customer Savings:      ${formatUSD(customerSavings)}/year (${(discountOffered * 100).toFixed(0)}% off)
Historical Annual:     ${formatUSD(historicalAnnual)}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
eMIXER CONFIGURATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Customer Flag:         INK CLUB = TRUE
FC Multiplier:         Ã— ${discountedMultiplier.toFixed(2)}

Multiplier Calculation:
  Full Price:     1 Ã· (1 - ${(historicalMargin * 100).toFixed(0)}%) = ${fullMultiplier.toFixed(2)}
  With Discount:  ${fullMultiplier.toFixed(2)} Ã— (1 - ${(discountOffered * 100).toFixed(0)}%) = ${discountedMultiplier.toFixed(2)}

Monthly FC Budget:     ${formatUSD(monthlyCOGS)}
Annual FC Budget:      ${formatUSD(historicalCOGS)}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ACCOUNT LIMITS (MONTHLY FC)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Baseline:              ${formatUSD(monthlyCOGS)}
Soft Limit (+${(softCapPct * 100).toFixed(0)}%):     ${formatUSD(softLimitFC)} â€” internal flag
Hard Limit (${hardCapMultiplier}Ã—):       ${formatUSD(hardLimitFC)} â€” overage billing

Overage Rate:          ${(overageMarkup * 100).toFixed(0)}% markup on FC beyond hard limit

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
MONTHLY RECONCILIATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ERP books each order at: FC Ã— ${discountedMultiplier.toFixed(2)} (Internal Price)

End of month:
1. Sum all Internal Prices booked
2. Compare to Ink Club Rate: ${formatUSD(monthlyRate)}
3. Book journal entry for difference

If Internal Price < Ink Club Rate:
  Debit:  Accounts Receivable
  Credit: Ink Club Revenue

If Internal Price > Ink Club Rate:
  Debit:  Ink Club Adjustment
  Credit: Accounts Receivable

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
YEAR-END RECONCILIATION (DECEMBER)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Credit Threshold:      ${(creditThreshold * 100).toFixed(0)}% under baseline
Credit Percentage:     ${(creditPct * 100).toFixed(0)}% of unused value
Payment Deadline:      December ${decPaymentDeadline}

Max Potential Credit:  ${formatUSD(maxCredit)}

CREDIT FORMULA:
  If Annual FC < ${formatUSD(historicalCOGS * creditThresholdPct)} (${(creditThresholdPct * 100).toFixed(0)}% of baseline):
  Credit = (${formatUSD(historicalCOGS)} - Actual FC) Ã— ${discountedMultiplier.toFixed(2)} Ã— ${(creditPct * 100).toFixed(0)}%

DECEMBER TIMELINE:
â€¢ Nov 1-30:  Last full shipping month
â€¢ Dec 1-15:  Ship only to accounts current through October
â€¢ Dec 15:    SHIPPING CUTOFF for accounts with any balance
â€¢ Dec ${decPaymentDeadline}:    PAYMENT DEADLINE â€” all invoices due
â€¢ Dec 21-31: Calculate credits
â€¢ Jan 1:     Credits applied to January invoice

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PAYMENT CONTROLS (JAN-NOV)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Payment Terms:         NET ${paymentTerms}
Credit Hold:           Day ${holdStartDay} (${creditHoldDays} days past due)
Account Suspend:       Day ${suspendStartDay} (${accountSuspendDays} days past due)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
MONTHLY REVIEW CHECKLIST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Pull total FC shipped from eMixer
â–¡ Compare to baseline: ${formatUSD(monthlyCOGS)}
â–¡ Flag if over soft limit: ${formatUSD(softLimitFC)}
â–¡ Calculate overage if over hard limit: ${formatUSD(hardLimitFC)}
â–¡ Pull ERP booked revenue (sum of Internal Prices)
â–¡ Calculate reconciliation entry
â–¡ Book journal entry
â–¡ Invoice customer flat rate: ${formatUSD(monthlyRate)}
â–¡ Check AR aging â€” hold shipping if past Day ${holdStartDay}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
INCLUDED IN INK CLUB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Paper Series, Direct/Indirect Thermal, Laminating Films
âœ“ All baseline pigments
âœ“ Pre-mixed PMS colors
âœ“ Extenders, OPVs, Opaque White

NOT INCLUDED (bill separately at standard rates):
âœ— Fluorescents, Metallics, Specialty Pigments
âœ— UV/LED systems
âœ— Usage beyond hard limit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;

      $('exportOutput').textContent = exportText;
    }
    
    function copyExport() {
      navigator.clipboard.writeText($('exportOutput').textContent)
        .then(() => alert('Copied to clipboard'));
    }
    
    function downloadExport() {
      const text = $('exportOutput').textContent;
      const name = $('customerName').value || 'Customer';
      const filename = `Ink-Club-${name.replace(/[^a-zA-Z0-9]/g, '-')}-${new Date().toISOString().split('T')[0]}.txt`;
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }
    
    // Event listeners
    const inputIds = [
      'customerName','agreementStart','historicalAnnual','historicalMargin','discountOffered',
      'contractTerm','paymentTerms','softCapPct','hardCapMultiplier','overageMarkup',
      'creditThreshold','creditPct','decPaymentDeadline','creditHoldDays','accountSuspendDays',
      'actualFC'
    ];
    
    inputIds.forEach(id => {
      const el = $(id);
      if (el) el.addEventListener(el.tagName === 'SELECT' ? 'change' : 'input', calculate);
    });
    
    calculate();
  </script>
</body>
</html>
